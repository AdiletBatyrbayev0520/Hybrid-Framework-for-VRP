# Компонент динамического программирования (DP)

Данный компонент реализует решение задачи коммивояжера (TSP) с использованием алгоритма Хелда-Карпа, который основан на методе динамического программирования.

## Структура директории

```
DP_part/
├── environment/                # Модули для генерации тестовых данных
│   └── generate_env.py         # Скрипт для создания тестовых наборов данных
├── held_karp.py                # Основная реализация алгоритма Хелда-Карпа
├── dp_api.py                   # API для работы с алгоритмом через REST
└── tests/                      # Тестовые данные
    └── test_*/                 # Поддиректории с тестовыми сценариями
        ├── cities.csv          # Координаты городов
        ├── distances.csv       # Матрица расстояний
        └── best_route.txt      # Найденный оптимальный маршрут
```

## Алгоритм Хелда-Карпа

Это точный алгоритм решения задачи коммивояжера со сложностью O(n²·2ⁿ), где n - количество городов. Алгоритм гарантированно находит оптимальное решение для задачи TSP.

### Основные характеристики:
- **Временная сложность**: O(n²·2ⁿ)
- **Пространственная сложность**: O(n·2ⁿ)
- **Точность**: Гарантированно находит оптимальное решение
- **Ограничения**: Практически применим для задач с не более чем 20-25 городами из-за экспоненциального роста сложности

## Использование компонента

### Запуск алгоритма Хелда-Карпа напрямую

```bash
python DP_part/held_karp.py --input_path path/to/data/folder --save_path path/to/save
```

Параметры:
- `--input_path`: путь к папке с файлами cities.csv и distances.csv
- `--save_path`: путь для сохранения результатов
- `--csv`: флаг, указывающий, что используются CSV-файлы (по умолчанию True)

### Запуск API-сервера

```bash
python DP_part/dp_api.py
```

API-сервер запускается на порту 8000 и предоставляет REST API для решения задачи коммивояжера.

#### Пример запроса к API:

```bash
curl -X POST http://localhost:8000/solve \
  -H "Content-Type: application/json" \
  -d '{"distance_matrix": [[0, 10, 15, 20], [10, 0, 35, 25], [15, 35, 0, 30], [20, 25, 30, 0]]}'
```

## Генерация тестовых данных

Для создания новых тестовых наборов данных используйте скрипт generate_env.py:

```bash
python DP_part/environment/generate_env.py --num_cities 10 --save_path DP_part/tests/test_new
```

Параметры:
- `--num_cities`: количество городов в тестовом наборе
- `--save_path`: путь для сохранения сгенерированных файлов

Скрипт создаст файлы cities.csv и distances.csv в указанной директории.

## Ограничения и особенности

1. **Ограничение размерности**: Из-за экспоненциальной сложности рекомендуется использовать этот алгоритм для задач с не более чем 20 городами.

2. **Гарантии**: Алгоритм всегда находит оптимальное решение, но может потребовать значительных вычислительных ресурсов.

3. **Формат матрицы расстояний**: Матрица должна быть симметричной с нулями на главной диагонали, что соответствует неориентированному графу с положительными весами рёбер.

## Зависимости

- numpy
- pandas
- fastapi (для API)
- uvicorn (для запуска API-сервера) 